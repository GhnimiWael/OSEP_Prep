```


         ██████╗ ██╗  ██╗██╗    ██╗██╗  ██╗██████╗ ██╗               ██████╗ ███████╗███████╗██████╗ 
        ██╔═████╗╚██╗██╔╝██║    ██║██║  ██║╚════██╗██║              ██╔═══██╗██╔════╝██╔════╝██╔══██╗
        ██║██╔██║ ╚███╔╝ ██║ █╗ ██║███████║ █████╔╝██║    █████╗    ██║   ██║███████╗█████╗  ██████╔╝
        ████╔╝██║ ██╔██╗ ██║███╗██║╚════██║ ╚═══██╗██║    ╚════╝    ██║   ██║╚════██║██╔══╝  ██╔═══╝ 
        ╚██████╔╝██╔╝ ██╗╚███╔███╔╝     ██║██████╔╝███████╗         ╚██████╔╝███████║███████╗██║     
         ╚═════╝ ╚═╝  ╚═╝ ╚══╝╚══╝      ╚═╝╚═════╝ ╚══════╝          ╚═════╝ ╚══════╝╚══════╝╚═╝     

                    - Website/blog: https://ghnimiwael.github.io/
                    - https://x.com/GhnimiWael (@GhnimiWael)   
```
# PEN-300: Advanced Evasion Techniques and Breaching Defenses

<img src="https://images.credly.com/images/ebefd276-7f47-4aa8-b1d8-4a13636e4851/twitter_thumb_201604_image.png" width="220" height="220" align="left">

Building on the skills acquired in PEN-200, OffSec’s PEN-300 course explores advanced penetration testing techniques against hardened targets. Learners gain hands-on experience bypassing security defenses and crafting custom exploits in real-world scenarios, enhancing their expertise in ethical hacking and vulnerability assessment.

This self-paced course culminates in a challenging exam, leading to the OffSec Experienced Penetration Tester (OSEP) certification. Achieving the OSEP certification distinguishes professionals with advanced penetration testing skills, making them highly sought-after experts in securing organizations from sophisticated threats.

# Official Link

Link: https://www.offsec.com/courses/pen-300/

# Exam Day
<h3 align="center">
=> 27-10-2024 <=
</h3>

<p align="center">
<img src="https://i.pinimg.com/1200x/14/1d/a2/141da2bbea4a9288e9f4da913c4b32c5.jpg">
</p>

# Related Resources
- Official student Forum: https://forums.offensive-security.com
- Live Support & Discord: https://help.offsec.com/hc/en-us
- Exam Guide: https://help.offsec.com/hc/en-us/articles/360050293792-OSEP-Exam-Guide
- *This repo is so influenced by r0r0x-xx & nullg0re*
## Chapter 1 - Copyright
Just a Copyright .. ^^ No further resources

<p align="center">
<img src="https://i.pinimg.com/564x/63/53/2c/63532c21e7e730286a6c673bdfb3192b.jpg" >
</p>

## Chapter 2 - General Course Information
- OSEP - Offensive Security Experienced Penetration Tester (REVIEW): https://www.youtube.com/watch?v=iUPyiJbN4l4&t=128s
- OSEP Review - What YOU Need to Know! (UPDATED EXAM): https://www.youtube.com/watch?v=R1apMwbVuDs

## Chapter 3 - Operating System and Programming Theory

<p align="center">
<img src="https://i.pinimg.com/1200x/a2/44/7f/a2447fdf9e47e826173f886059c616c6.jpg" height="400">
</p>

### Chapter 3.1 - Programming
- Bash: https://www.youtube.com/watch?v=smbeKPDVs2I
- Python: https://www.youtube.com/playlist?list=PLBf0hzazHTGM_dncTqO9l-0zUQYP0nNPU
- PowerShell: https://resources.infosecinstitute.com/topic/powershell-for-pentesters-part-1-introduction-to-powershell-and-cmdlets/
- C#: 
	- https://www.youtube.com/watch?v=GhQdlIFylQ8
	- https://github.com/mvelazc0/defcon27_csharp_workshop
	- https://www.tutorialspoint.com/csharp/index.htm
- Introduction to VBA: https://docs.microsoft.com/en-us/office/vba/library-reference/concepts/getting-started-with-vba-in-office

### Chapter 3.2 - System
- Win32 API’s:
	- https://posts.specterops.io/offensive-p-invoke-leveraging-the-win32-api-from-managed-code-7eef4fdef16d
	- https://rastamouse.me/blog/process-injection-dinvoke/
	- https://www.pinvoke.net/
- Windows Registry:
	- https://en.wikipedia.org/wiki/Windows_Registry
	- https://www.lifewire.com/windows-registry-2625992
- WoW64:
	- https://en.wikipedia.org/wiki/WoW64
	- https://learn.microsoft.com/fr-fr/windows/win32/winprog64/wow64-implementation-details

## Chapter 4 - Client Side Code Execution With Office

<p align="center">
<img src="https://i.pinimg.com/1200x/73/9a/8c/739a8cb90a00fc0ed83e3f2869486fcf.jpg" height="300" width="1000">
</p>

- Staged vs. Non-staged Payloads: https://buffered.io/posts/staged-vs-stageless-handlers/
- Droppers / Stagers: 
	- https://en.wikipedia.org/wiki/Dropper_(malware)
	- https://rastamouse.me/blog/asb-bypass-pt2/ - Use Wayback Machine (2021)
- HTML Smuggling (Not HTTP Request Smuggling):
	- https://outflank.nl/blog/2018/08/14/html-smuggling-explained/
	- https://github.com/Arno0x/EmbedInHTML
- Phishing With Microsoft Office
	- https://digitalguardian.com/blog/what-macro-malware
	- https://docs.microsoft.com/en-us/windows/security/threat-protection/intelligence/macro-malware
	- https://support.microsoft.com/en-us/office/automatically-run-a-macro-when-opening-a-workbook-1e55959b-e077-4c88-a696-c3017600db44
	- https://stackoverflow.com/questions/51296291/auto-open-sub-vba/51296480
- Phishing Pretexts:
	- https://github.com/L4bF0x/PhishingPretexts
- Calling Win32 APIs from VBA:
	- https://www.aeternus.sg/how-to-use-windows-api-in-vba/ - *Use Wayback Machine (2020)*
	- https://renenyffenegger.ch/notes/development/languages/VBA/Win-API/index
	- https://learn.microsoft.com/en-us/dotnet/visual-basic/programming-guide/com-interop/walkthrough-calling-windows-apis
- VBA Shellcode Runners:
	- https://www.scriptjunkie.us/2012/01/direct-shellcode-execution-in-ms-office-macros/
	- https://www.bitdam.com/2018/05/22/propertybomb-an-old-new-technique-for-arbitrary-code-execution-in-vba-macro/ - *Use Wayback Machine (2020)*
	- https://github.com/infosecn1nja/MaliciousMacroMSBuild - *Doesn't work so well (This is OLD VERSION) !!*
- PowerShell Shellcode Runner:
	- https://devblogs.microsoft.com/scripting/use-powershell-to-interact-with-the-windows-api-part-1/
	- https://www.raydbg.com/2017/Call-Native-Win32-API-in-PowerShell/
	- https://github.com/PowerShellMafia/PowerSploit/blob/master/CodeExecution/Invoke-Shellcode.ps1
	- https://powersploit.readthedocs.io/en/latest/CodeExecution/Invoke-ReflectivePEInjection/
	- https://stackoverflow.com/questions/63593930/how-to-call-a-win32-api-function-from-powershell
	- https://www.defcon.org/images/defcon-21/dc-21-presentations/Bialek/DEFCON-21-Bialek-PowerPwning-Post-Exploiting-by-Overpowering-Powershell.pdf
- PowerShell in Memory:
	- https://isc.sans.edu/forums/diary/Fileless+Malicious+PowerShell+Sample/23081/
	- https://github.com/PowerShell/PowerShell/blob/master/src/Microsoft.PowerShell.CoreCLR.Eventing/DotNetCode/Eventing/UnsafeNativeMethods.cs
- DelegateType Reflection:
	- https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/delegates/
	- https://learn.microsoft.com/en-us/dotnet/fundamentals/reflection/how-to-hook-up-a-delegate-using-reflection
	- https://www.powershellgallery.com/packages/poke/1.0.0.2/Content/delegate.ps1
- Proxy-Aware PowerShell Communications:
	- http://woshub.com/using-powershell-behind-a-proxy/
	- https://stackoverflow.com/questions/14263359/access-web-using-powershell-and-proxy
	- https://cloudrun.co.uk/powershell/configuring-powershell-to-work-behind-a-proxy-server/
	- https://medium.com/river-yang/powershell-working-behind-a-proxy-with-authentication-eb68a337f222
## Chapter 5 - Client Side Code Execution with Windows Script Host

<p align="center">
<img src="https://i.pinimg.com/1200x/b7/04/2f/b7042ff8500c374b8208a101e54d3f85.jpg" height="400">
</p>

- JScript Execution: https://docs.microsoft.com/en-us/previous-versions/windows/desktop/indexsrv/running-a-jscript-query
- JScript Basic Dropper: https://github.com/hlldz/SpookFlare
- HTA, VBA, JScript, CScript Payload Creation and Obfuscation:
	- https://github.com/tyranid/DotNetToJScript
	- https://github.com/med0x2e/GadgetToJScript
- SharpShooter:
	- https://github.com/mdsecactivebreach/SharpShooter

## Chapter 6 - Process Injection and Migration

<p align="center">
<img src="https://i.pinimg.com/736x/7e/54/48/7e544881666d8bc94423a135f748f9ae.jpg" height="400">
</p>

- Process Injection:
	- https://github.com/3xpl01tc0d3r/ProcessInjection
	- https://github.com/secrary/InjectProc
	- https://rastamouse.me/blog/process-injection-dinvoke/ - *User WayBack Machine*
	- https://www.ired.team/offensive-security/defense-evasion/parent-process-id-ppid-spoofing
- DLL Injection
	- https://en.wikipedia.org/wiki/DLL_injection#:~:text=In%20computer%20programming%2C%20DLL%20injection,did%20not%20anticipate%20or%20intend
	- https://medium.com/bug-bounty-hunting/dll-injection-attacks-in-a-nutshell-71bc84ac59bd
	- https://www.youtube.com/watch?v=yKoD5Oy8CKQ
	- https://github.com/milkdevil/injectAllTheThings
	- http://blog.opensecurityresearch.com/2013/01/windows-dll-injection-basics.html  - *User WayBack Machine*
- Reflective DLL Injection
	- https://github.com/stephenfewer/ReflectiveDLLInjection
	- https://clymb3r.wordpress.com/2013/04/06/reflective-dll-injection-with-powershell/
	- https://github.com/PowerShellMafia/PowerSploit/blob/master/CodeExecution/Invoke-ReflectivePEInjection.ps1
- Process Hollowing
	- https://gist.github.com/smgorelik/9a80565d44178771abf1e4da4e2a0e75
	- https://github.com/caesartcs/ProcessHollowing
	- https://github.com/m0n0ph1/Process-Hollowing
	- https://trustedsec.com/blog/the-nightmare-of-proc-hollows-exe

## Chapter 7 - Introduction to Antivirus Evasion

<p align="center">
<img src="https://i.pinimg.com/1200x/e1/7c/6e/e17c6e4b331020e549606494d87c7446.jpg" height="400">
</p>

- Metasploit Encryptors: https://blog.rapid7.com/2019/11/21/metasploit-shellcode-grows-up-encrypted-and-authenticated-c-shells/
- .NET/C# AES Payload Encryption:
	- https://sevrosecurity.com/2019/05/25/bypass-windows-defender-with-a-simple-shell-loader/ - *User WayBack Machine*
	- https://github.com/cribdragg3r/Simple-Loader

## Chapter 8 - Advanced Antivirus Evasion
- Antimalware Scanning Interface (AMSI):
	- https://rastamouse.me/2018/10/amsiscanbuffer-bypass---part-1/ - *User WayBack Machine*
	- https://rastamouse.me/blog/asb-bypass-pt2/ - *User WayBack Machine*
	- https://rastamouse.me/blog/asb-bypass-pt3/ - *User WayBack Machine*
	- https://rastamouse.me/blog/asb-bypass-pt4/ - *User WayBack Machine*
- AntiScan.me: https://antiscan.me/

## Chapter 9 - Application Whitelisting

<p align="center">
<img src="https://i.pinimg.com/1200x/f6/a6/65/f6a665ab25094f7dc689377be53dcb76.jpg" height="400">
</p>

- Theory: https://www.techtarget.com/searchsecurity/definition/application-whitelisting#:~:text=Application%20whitelisting%20is%20the%20practice,networks%20from%20potentially%20harmful%20applications
- Bypass:
	- https://github.com/api0cradle/UltimateAppLockerByPassList
	- https://github.com/0xVIC/myAPPLockerBypassSummary

## Chapter 9 - Bypassing Network Filters

<p align="center">
<img src="https://i.pinimg.com/1200x/c5/70/33/c57033fa3f5dfdb869154de7f91ecae8.jpg" height="400">
</p>

- Domain Fronting:
	- https://digi.ninja/blog/domain_fronting.php
	- https://attack.mitre.org/techniques/T1090/004/
	- https://medium.com/@malcomvetter/simplifying-domain-fronting-8d23dcb694a0
- DNS Tunneling:
	- https://www.paloaltonetworks.com/cyberpedia/what-is-dns-tunneling
	- https://unit42.paloaltonetworks.com/dns-tunneling-how-dns-can-be-abused-by-malicious-actors/
## Chapter 11 - Linux Post-Exploitation

<p align="center">
<img src="https://i.pinimg.com/1200x/62/96/82/6296820e3415770b2a8c27bd466ba8ef.jpg" height="400">
</p>

- Antiscan.me: https://antiscan.me/
- Shared DLL Hijacking: 
	- https://www.contextis.com/en/blog/linux-privilege-escalation-via-dynamically-linked-shared-object-library
	- https://www.boiteaklou.fr/Abusing-Shared-Libraries.html
	- https://sumit-ghosh.com/articles/hijacking-library-functions-code-injection-ld-preload/
- Command List: https://github.com/mubix/post-exploitation/wiki/Linux-Post-Exploitation-Command-List
## Chapter 12 - Kiosk Breakout

<p align="center">
<img src="https://i.pinimg.com/1200x/69/f3/64/69f364f2fcc6ce78e3aed83b73f1f18c.jpg" height="400">
</p>

- Kiosk Breakouts / Attacks:
	- https://www.trustedsec.com/blog/kioskpos-breakout-keys-in-windows/
	- https://sra.io/blog/sitekiosk-breakout/
	- https://www.boiteaklou.fr/Abusing-Shared-Libraries.html
	- https://www.engetsu-consulting.com/blog/kiosk-breakout-windows
	- https://ppn.snovvcrash.rocks/pentest/infrastructure/kiosk-breakout
## Chapter 13 - Windows Credentials

<p align="center">
<img src="https://i.pinimg.com/1200x/1b/57/4c/1b574c579236a84246958ffadb9fcb43.jpg" height="400">
</p>

- Local Windows Credentials:
	-  SAM Dump: https://medium.com/@sanjumalhotra26/dumping-credentials-from-sam-file-using-mimikatz-and-cracking-with-john-the-ripper-and-hashcat-ce5bbf2f4f5a
	- Hardening the Local Admin Account (LAPS):
		- https://rastamouse.me/blog/laps-pt1/ - *Use WayBack Machine*
		- https://rastamouse.me/blog/laps-pt2/ - *Use WayBack Machine*
		- https://github.com/kfosaaen/Get-LAPSPasswords
		- https://blog.netspi.com/running-laps-around-cleartext-passwords/
- Access Token: https://foxglovesecurity.com/2017/08/25/abusing-token-privileges-for-windows-local-privilege-escalation/

## Chapter 14 - Windows Lateral Movement

<p align="center">
<img src="https://i.pinimg.com/1200x/a5/5b/61/a55b6130ae5283c47804d5a0daa29ab4.jpg" height="400">
</p>

- Microsoft Defender Lateral Movement Paths: https://docs.microsoft.com/en-us/defender-for-identity/use-case-lateral-movement-path
- Offensive Lateral Movement: https://posts.specterops.io/offensive-lateral-movement-1744ae62b14f
- Restricting SMB: https://medium.com/palantir/restricting-smb-based-lateral-movement-in-a-windows-environment-ed033b888721

## Chapter 15 - Linux Lateral Movement

<p align="center">
<img src="https://i.pinimg.com/1200x/33/e8/97/33e897f37ff3de7b68a84866e0697ffa.jpg" height="400">
</p>

- MITRE: https://attack.mitre.org/matrices/enterprise/linux/
- Lateral Movement with shell: https://redcanary.com/blog/lateral-movement-with-secure-shell/
- Post exploit: https://mrw0r57.github.io/2020-05-31-linux-post-exploitation-10-4/

## Chapter 16 - Microsoft SQL Attacks

<p align="center">
<img src="https://i.pinimg.com/1200x/ea/fc/be/eafcbe2515edad2caa2432ab7fb18222.jpg" height="400">
</p>

- MS SQL Enumeration::
  - https://www.mssqltips.com/sqlservertip/2013/find-sql-server-instances-across-your-network-using-windows-powershell/
  - https://www.mssqltips.com/sqlservertip/4181/inventory-sql-logins-on-a-sql-server-with-powershell/
 - NC Path Injection:
  - https://gist.github.com/nullbind/7dfca2a6309a4209b5aeef181b676c6e
  - https://blog.netspi.com/executing-smb-relay-attacks-via-sql-server-using-metasploit/
  - https://hackingandsecurity.blogspot.com/2017/07/10-places-to-stick-your-unc-path.html
  - https://secure360.org/wp-content/uploads/2017/05/SQL-Server-Hacking-on-Scale-UsingPowerShell_S.Sutherland.pdf

## Chapter 17 - Active Directory Exploitation

<p align="center">
<img src="https://i.pinimg.com/1200x/bf/fb/0b/bffb0b5d7e84d6b975b310dc6fc71394.jpg" height="200" width="1000">
</p>

- BloodHound: https://github.com/BloodHoundAD/BloodHound
  - Ingestors:
    - https://github.com/BloodHoundAD/SharpHound
    - https://github.com/BloodHoundAD/BloodHound/blob/master/Collectors/AzureHound.ps1
    - https://github.com/BloodHoundAD/BloodHound/blob/master/Collectors/SharpHound.ps1
    - https://github.com/fox-it/BloodHound.py

- Abusing Object Security Permissions: https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/abusing-active-directory-acls-aces

- Kerberos Delegation:
    - Unconstrained Delegation:
        - https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1
        - https://dirkjanm.io/krbrelayx-unconstrained-delegation-abuse-toolkit/
        - https://www.qomplx.com/qomplx-knowledge-kerberos-delegation-attacks-explained/
    - Constrained Delegation:
        - https://www.guidepointsecurity.com/delegating-like-a-boss-abusing-kerberos-delegation-in-active-directory/
        - https://stealthbits.com/blog/constrained-delegation-abuse-abusing-constrained-delegation-to-achieve-elevated-access/
    - Resource-Based Constrained Delegation:
        - https://shenaniganslabs.io/2019/01/28/Wagging-the-Dog.html
        - https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/resource-based-constrained-delegation-ad-computer-object-take-over-and-privilged-code-execution
    - Active Directoy Inter-Forest Exploitation:
        - http://www.harmj0y.net/blog/redteaming/a-guide-to-attacking-domain-trusts/
        - https://www.harmj0y.net/blog/redteaming/not-a-security-boundary-breaking-forest-trusts/
        - https://adsecurity.org/?p=1588
        - https://github.com/S1ckB0y1337/Active-Directory-Exploitation-Cheat-Sheet

# Tools & Scripts & Repos:
<p align="center">
<img src="https://i.pinimg.com/1200x/42/c5/c8/42c5c871a2f06ffadfdd8e732ad432b5.jpg" height="400">
</p>

- BloodHoundL: https://github.com/BloodHoundAD/BloodHound
- CrackMapExec: https://github.com/byt3bl33d3r/CrackMapExec
- JAWS: https://github.com/411Hall/JAWS
- Linux priv checker: https://github.com/sleventyeleven/linuxprivchecker
- Ligolo-ng: https://systemweakness.com/pivoting-for-newbies-with-ligolo-ng-82f13040aa39
- impacket: https://github.com/fortra/impacket
- BadAssMacros: https://github.com/Inf0secRabbit/BadAssMacros
- DotNetToJScript: https://github.com/tyranid/DotNetToJScript
- GadgetToJScript: https://github.com/med0x2e/GadgetToJScript
- bypass-clm: https://github.com/calebstewart/bypass-clm
- OSEP-Code-Snippets: https://github.com/chvancooten/OSEP-Code-Snippets
- OSEP-Tools-v2: https://github.com/hackinaggie/OSEP-Tools-v2

# END OF PREP ... SEE IN NEXT CERT ♥ ...
## Result Received: 
=> 05-11-2024 (Passed the Exam) <=

# Email & Cert
<p align="center">
<img src="https://i.imgur.com/8cqgaSl.png">
</p>

<p align="center">
<img src="https://media.licdn.com/dms/image/v2/D5622AQE-nHbItG1Ptw/feedshare-shrink_1280/feedshare-shrink_1280/0/1730830185297?e=1733961600&v=beta&t=v4ShqP_9oc1wLpYxjXGeZqyxvv82A6oXBkWGimnO7Go">
</p>

- 
